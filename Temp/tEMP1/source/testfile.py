
import pandas as pd
import json

filename = '../data/raw/xrates_aud_nzd_20240308_20240407_20240407193922.json'
# Read the JSON file (replace 'data.json' with your actual file path)
with open(filename, 'r') as json_file:
    json_data = json.load(json_file)

# Your exchange rate data (replace with the actual JSON data)
#exchange_rate_json = '{"meta": {"code": 200, "disclaimer": "Usage subject to terms: https://currencybeacon.com/terms"}, "response": {"2024-03-08": {"NZD": 1.07286486, "XYZ": null, "USD": 0.6625462}, "2024-03-09": {"NZD": 1.07381226, "XYZ": null, "USD": 0.66307984}, "2024-03-10": {"NZD": 1.07123743, "XYZ": null, "USD": 0.66141572}, "2024-03-11": {"NZD": 1.07171823, "XYZ": null, "USD": 0.66176335}, "2024-03-12": {"NZD": 1.07322869, "XYZ": null, "USD": 0.66126789}, "2024-03-13": {"NZD": 1.07384764, "XYZ": null, "USD": 0.66118311}, "2024-03-14": {"NZD": 1.07567608, "XYZ": null, "USD": 0.65642105}, "2024-03-15": {"NZD": 1.07897508, "XYZ": null, "USD": 0.65629439}, "2024-03-16": {"NZD": 1.07896644, "XYZ": null, "USD": 0.65627531}, "2024-03-17": {"NZD": 1.07696458, "XYZ": null, "USD": 0.6563356}, "2024-03-18": {"NZD": 1.07721586, "XYZ": null, "USD": 0.653494}, "2024-03-19": {"NZD": 1.0799807, "XYZ": null, "USD": 0.65359578}, "2024-03-20": {"NZD": 1.08666924, "XYZ": null, "USD": 0.66245095}, "2024-03-21": {"NZD": 1.08566102, "XYZ": null, "USD": 0.65323636}, "2024-03-22": {"NZD": 1.08709576, "XYZ": null, "USD": 0.65156632}, "2024-03-23": {"NZD": 1.08707893, "XYZ": null, "USD": 0.65149967}, "2024-03-24": {"NZD": 1.08694905, "XYZ": null, "USD": 0.65141227}, "2024-03-25": {"NZD": 1.08780117, "XYZ": null, "USD": 0.65577396}, "2024-03-26": {"NZD": 1.08813586, "XYZ": null, "USD": 0.65197796}, "2024-03-27": {"NZD": 1.09052053, "XYZ": null, "USD": 0.65325065}, "2024-03-28": {"NZD": 1.09013574, "XYZ": null, "USD": 0.65122447}, "2024-03-29": {"NZD": 1.09056382, "XYZ": null, "USD": 0.65191218}, "2024-03-30": {"NZD": 1.09078622, "XYZ": null, "USD": 0.65210595}, "2024-03-31": {"NZD": 1.09079277, "XYZ": null, "USD": 0.65263955}, "2024-04-01": {"NZD": 1.09092306, "XYZ": null, "USD": 0.64888493}, "2024-04-02": {"NZD": 1.09194589, "XYZ": null, "USD": 0.65117924}, "2024-04-03": {"NZD": 1.09209343, "XYZ": null, "USD": 0.65816954}, "2024-04-04": {"NZD": 1.09261778, "XYZ": null, "USD": 0.6568116}, "2024-04-05": {"NZD": 1.09443405, "XYZ": null, "USD": 0.65807978}, "2024-04-06": {"NZD": 1.09409881, "XYZ": null, "USD": 0.65788366}, "2024-04-07": {"NZD": 1.09399998, "XYZ": null, "USD": 0.65782287}}, "2024-03-08": {"NZD": 1.07286486, "XYZ": null, "USD": 0.6625462}, "2024-03-09": {"NZD": 1.07381226, "XYZ": null, "USD": 0.66307984}, "2024-03-10": {"NZD": 1.07123743, "XYZ": null, "USD": 0.66141572}, "2024-03-11": {"NZD": 1.07171823, "XYZ": null, "USD": 0.66176335}, "2024-03-12": {"NZD": 1.07322869, "XYZ": null, "USD": 0.66126789}, "2024-03-13": {"NZD": 1.07384764, "XYZ": null, "USD": 0.66118311}, "2024-03-14": {"NZD": 1.07567608, "XYZ": null, "USD": 0.65642105}, "2024-03-15": {"NZD": 1.07897508, "XYZ": null, "USD": 0.65629439}, "2024-03-16": {"NZD": 1.07896644, "XYZ": null, "USD": 0.65627531}, "2024-03-17": {"NZD": 1.07696458, "XYZ": null, "USD": 0.6563356}, "2024-03-18": {"NZD": 1.07721586, "XYZ": null, "USD": 0.653494}, "2024-03-19": {"NZD": 1.0799807, "XYZ": null, "USD": 0.65359578}, "2024-03-20": {"NZD": 1.08666924, "XYZ": null, "USD": 0.66245095}, "2024-03-21": {"NZD": 1.08566102, "XYZ": null, "USD": 0.65323636}, "2024-03-22": {"NZD": 1.08709576, "XYZ": null, "USD": 0.65156632}, "2024-03-23": {"NZD": 1.08707893, "XYZ": null, "USD": 0.65149967}, "2024-03-24": {"NZD": 1.08694905, "XYZ": null, "USD": 0.65141227}, "2024-03-25": {"NZD": 1.08780117, "XYZ": null, "USD": 0.65577396}, "2024-03-26": {"NZD": 1.08813586, "XYZ": null, "USD": 0.65197796}, "2024-03-27": {"NZD": 1.09052053, "XYZ": null, "USD": 0.65325065}, "2024-03-28": {"NZD": 1.09013574, "XYZ": null, "USD": 0.65122447}, "2024-03-29": {"NZD": 1.09056382, "XYZ": null, "USD": 0.65191218}, "2024-03-30": {"NZD": 1.09078622, "XYZ": null, "USD": 0.65210595}, "2024-03-31": {"NZD": 1.09079277, "XYZ": null, "USD": 0.65263955}, "2024-04-01": {"NZD": 1.09092306, "XYZ": null, "USD": 0.64888493}, "2024-04-02": {"NZD": 1.09194589, "XYZ": null, "USD": 0.65117924}, "2024-04-03": {"NZD": 1.09209343, "XYZ": null, "USD": 0.65816954}, "2024-04-04": {"NZD": 1.09261778, "XYZ": null, "USD": 0.6568116}, "2024-04-05": {"NZD": 1.09443405, "XYZ": null, "USD": 0.65807978}, "2024-04-06": {"NZD": 1.09409881, "XYZ": null, "USD": 0.65788366}, "2024-04-07": {"NZD": 1.09399998, "XYZ": null, "USD": 0.65782287}}'
#exchange_rate_json = json_data
# Load JSON data into a dictionary
#exchange_rate_data = json.loads(str(json_data))

# Create a DataFrame from the dictionary
df = pd.DataFrame.from_dict(json_data['response'],orient="index")

# Print the DataFrame
print(df)
df.columns = ["date","currencyrate","currencytype"]
df.to_csv('../data/staging/xrates_aud_nzd_20240308_20240407193922.csv',index=False )
